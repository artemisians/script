 echo "IyEvdXNyL2Jpbi9lbnYgYmFzaAoKewogICAgbF9vdXRwdXQ9IiIKICAgIGxfb3V0cHV0Mj0iIgoKICAgICMgSW5pdGlhbGl6ZSBhbmQgcG9wdWxhdGUgYXJyYXkgd2l0aCBTU0ggY29uZmlndXJhdGlvbiBmaWxlcwogICAgdW5zZXQgYV9zc2hkZmlsZXMKICAgIGFfc3NoZGZpbGVzPSgpCgogICAgWyAtZSAiL2V0Yy9zc2gvc3NoZF9jb25maWciIF0gJiYgYV9zc2hkZmlsZXMrPSgiJChzdGF0IC1MYyAnJW5eJSNhXiVVXiVHJyAiL2V0Yy9zc2gvc3NoZF9jb25maWciKSIpCgogICAgIyBTdXBwcmVzcyAiTm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeSIgZXJyb3JzCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgLWQgJCdcMCcgbF9maWxlOyBkbwogICAgICAgIFsgLWUgIiRsX2ZpbGUiIF0gJiYgYV9zc2hkZmlsZXMrPSgiJChzdGF0IC1MYyAnJW5eJSNhXiVVXiVHJyAiJGxfZmlsZSIpIikKICAgIGRvbmUgPCA8KGZpbmQgL2V0Yy9zc2gvc3NoZF9jb25maWcuZCAtdHlwZSBmIFwoIC1wZXJtIC8wNzcgLW8gISAtdXNlciByb290IC1vICEgLWdyb3VwIHJvb3QgXCkgLXByaW50MCAyPi9kZXYvbnVsbCkKCiAgICBpZiAoKCAkeyNhX3NzaGRmaWxlc1tAXX0gIT0gMCApKTsgdGhlbgogICAgICAgIHBlcm1fbWFzaz0nMDE3NycKICAgICAgICBtYXhwZXJtPSIkKHByaW50ZiAnJW8nICQoKCAwNzc3ICYgfiRwZXJtX21hc2sgKSkpIgoKICAgICAgICB3aGlsZSBJRlM9Il4iIHJlYWQgLXIgbF9maWxlIGxfbW9kZSBsX3VzZXIgbF9ncm91cDsgZG8KICAgICAgICAgICAgbF9vdXQyPSIiCgogICAgICAgICAgICAjIENoZWNrIHBlcm1pc3Npb25zCiAgICAgICAgICAgIGlmIFsgJCgoIGxfbW9kZSAmIHBlcm1fbWFzayApKSAtZ3QgMCBdOyB0aGVuCiAgICAgICAgICAgICAgICBsX291dDI9IiRsX291dDJcbiAtIElzIG1vZGU6IFwiJGxfbW9kZVwiIHNob3VsZCBiZTogXCIkbWF4cGVybVwiIG9yIG1vcmUgcmVzdHJpY3RpdmUiCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICAjIENoZWNrIG93bmVyc2hpcAogICAgICAgICAgICBpZiBbICIkbF91c2VyIiAhPSAicm9vdCIgXTsgdGhlbgogICAgICAgICAgICAgICAgbF9vdXQyPSIkbF9vdXQyXG4gLSBJcyBvd25lZCBieSBcIiRsX3VzZXJcIiBzaG91bGQgYmUgb3duZWQgYnkgXCJyb290XCIiCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICAjIENoZWNrIGdyb3VwIG93bmVyc2hpcAogICAgICAgICAgICBpZiBbICIkbF9ncm91cCIgIT0gInJvb3QiIF07IHRoZW4KICAgICAgICAgICAgICAgIGxfb3V0Mj0iJGxfb3V0MlxuIC0gSXMgZ3JvdXAgb3duZWQgYnkgXCIkbF9ncm91cFwiIHNob3VsZCBiZSBncm91cCBvd25lZCBieSBcInJvb3RcIiIKICAgICAgICAgICAgZmkKCiAgICAgICAgICAgICMgUG9wdWxhdGUgb3V0cHV0IGJhc2VkIG9uIGNoZWNrcwogICAgICAgICAgICBpZiBbIC1uICIkbF9vdXQyIiBdOyB0aGVuCiAgICAgICAgICAgICAgICBsX291dHB1dDI9IiRsX291dHB1dDJcbiAtIEZpbGU6IFwiJGxfZmlsZVwiOiRsX291dDIiCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGxfb3V0cHV0PSIkbF9vdXRwdXRcbiAtIEZpbGU6IFwiJGxfZmlsZVwiOlxuIC0gQ29ycmVjdDogbW9kZSAoJGxfbW9kZSksIG93bmVyICgkbF91c2VyKSwgYW5kIGdyb3VwIG93bmVyICgkbF9ncm91cCkgY29uZmlndXJlZCIKICAgICAgICAgICAgZmkKICAgICAgICBkb25lIDw8PCAiJChwcmludGYgJyVzXG4nICIke2Ffc3NoZGZpbGVzW0BdfSIpIgogICAgZmkKCiAgICB1bnNldCBhX3NzaGRmaWxlcyAjIENsZWFyIGFycmF5CgogICAgIyBEaXNwbGF5IGF1ZGl0IHJlc3VsdHMKICAgIGlmIFsgLXogIiRsX291dHB1dDIiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICJcbi0gQXVkaXQgUmVzdWx0OlxuICoqKiBQQVNTICoqKlxuLSAqIENvcnJlY3RseSBzZXQgKiA6XG4kbF9vdXRwdXRcbiIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICJcbi0gQXVkaXQgUmVzdWx0OlxuICoqIEZBSUwgKipcbiAtICogUmVhc29ucyBmb3IgYXVkaXQgZmFpbHVyZSAqIDpcbiRsX291dHB1dDJcbiIKICAgICAgICBbIC1uICIkbF9vdXRwdXQiIF0gJiYgZWNobyAtZSAiIC0gKiBDb3JyZWN0bHkgc2V0ICogOlxuJGxfb3V0cHV0XG4iCiAgICBmaQp9Cg==" | base64 -d | bash


--OUTPUT--

- Audit Result:
 *** PASS ***
- * Correctly set * :

 - File: "/etc/ssh/sshd_config":
 - Correct: mode (0600), owner (root), and group owner (root) configured

